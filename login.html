<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-auth.js"></script>
    <script src="firebase-init.js"></script>
</head>
<body>
    <h1>Login</h1>
    <button id="googleLogin">Login with Google</button>

    <script>
      var provider = new firebase.auth.GoogleAuthProvider();
      
      document.getElementById("googleLogin").addEventListener("click", function(e) {
        e.preventDefault(); // Prevent default action, which might navigate away or refresh the page
        var provider = new firebase.auth.GoogleAuthProvider();
        firebase.auth().signInWithPopup(provider).then(function(result) {
          // This gives you a Google Access Token. You can use it to access the Google API.
          var token = result.credential.accessToken;
          // The signed-in user info.
          var user = result.user;
          // Redirect to forums or another page after successful login
          window.location.href = 'forums.html';
        }).catch(function(error) {   
          var errorCode = error.code;
          var errorMessage = error.message;
          console.log("Error signing in: ", errorMessage);
        });
      });

      firebase.auth().onAuthStateChanged((user) => {
        if (user) {
          window.location.href = 'forums.html'; // Redirect if already logged in
        }
      });
    </script>
</body>
</html>
